#summary One-sentence summary of this page.

<wiki:gadget url="http://android-query.googlecode.com/svn/trunk/demo/gadget/social.xml?v=2" height="115" width="700" border="0" /> 

==Authentication==

AQuery provides an easy and simple authentication mechanism for Google and other OAuth enabled services. The featured is designed for developers who prefer low level api access to Google API's, Facebook, and Twitter, etc...

==Permission==

For Google service, include these permissions:
{{{
<uses-permission android:name="android.permission.GET_ACCOUNTS" />	
<uses-permission android:name="android.permission.USE_CREDENTIALS" />		
}}}
==Code==

AQuery handles the authentication life cycle and token management automatically. Simply provide an "account handle" with the .auth() method. 

Here's a complete authentication example using Google's PICASA service:

{{{

GoogleHandle handle = new GoogleHandle(this, AQuery.AUTH_PICASA, AQuery.ACTIVE_ACCOUNT);

String url = "https://picasaweb.google.com/data/feed/api/user/default?alt=json";
aq.auth(handle).ajax(url, JSONObject.class, new AjaxCallback<JSONObject>(){
	@Override
	public void callback(String url, JSONObject object, AjaxStatus status) {
		System.out.println(object);
	}
});	


}}}

==Account Handle==

Account handle holds the current authentication token which are cached on the device. Account handle should be shared by all ajax calls within an activity that requires the same type of authentication.

==Supported Google Service==

Note: *Google Account Manager requires API 7+.*

The following Google Service is supported, with their corresponding token types:

|| *Name* || *Type* || *Google's API* ||
|| G Reader || AQuery.AUTH_READER || [http://code.google.com/p/pyrfeed/wiki/GoogleReaderAPI API] ||
|| Picasa || AQuery.AUTH_PICASA || [http://code.google.com/apis/picasaweb/docs/2.0/reference.html API] ||
|| Spreadsheets ||AQuery.AUTH_SPREADSHEETS || [http://code.google.com/apis/spreadsheets/data/3.0/reference.html API] ||
|| Youtube || AQuery.AUTH_YOUTUBE || [http://code.google.com/apis/youtube/2.0/developers_guide_protocol_audience.html API] ||
|| Analytics || AQuery.AUTH_ANALYTICS || [http://code.google.com/apis/analytics/docs/mgmt/v3/mgmtReference.html API] ||
|| Blogger|| AQuery.AUTH_BLOGGER || [http://code.google.com/apis/blogger/docs/2.0/json/using.html API] ||
|| Calendar || AQuery.AUTH_CALENDAR || [http://code.google.com/apis/calendar/v3/getting_started.html API] ||
|| Contacts|| AQuery.AUTH_CONTACTS || [http://code.google.com/apis/contacts/docs/3.0/reference.html API] ||
|| Maps || AQuery.AUTH_MAPS || [http://code.google.com/apis/maps/ API] ||


==Facebook==

{{{
public void auth_facebook(){
	
	FacebookHandle handle = new FacebookHandle(this, APP_ID, PERMISSIONS);
	
	String url = "https://graph.facebook.com/me/feed";
	aq.auth(handle).progress(R.id.progress).ajax(url, JSONObject.class, this, "facebookCb");
	
}

}}}


===Permission===

{{{
private static String PERMISSIONS = "read_stream,read_friendlists,manage_friendlists,manage_notifications,publish_stream,publish_checkins,offline_access,user_photos,user_likes,user_groups,friends_photos";
	
}}}

Permission are Facebook open graph "scope", as described [http://developers.facebook.com/docs/reference/api/permissions/ here]. Each terms are separated by comma.


==Twitter==

{{{

public void auth_twitter(){
	
	TwitterHandle handle = new TwitterHandle(this, CONSUMER_KEY, CONSUMER_SECRET);
	
	String url = "http://twitter.com/statuses/mentions.json";
	aq.auth(handle).progress(R.id.progress).ajax(url, JSONArray.class, this, "twitterCb");
	
	
}

}}}

Use the TwitterHandle to authenticate with OAuth1. Consumer key and consumer secret are provided from Twitter's app development console.

===Dependency===

The TwitterHandle depends on the [http://code.google.com/p/oauth-signpost/ SignPost] library:

  * signpost-commonshttp4-1.2.1.1.jar
  * signpost-core-1.2.1.1.jar

You can download the 2 jars [http://code.google.com/p/android-query/downloads/list here].

==Basic Auth==

{{{

public void auth_basic(){
	
	BasicHandle handle = new BasicHandle("tinyeeliu@gmail.com", "password");
	String url = "http://xpenser.com/api/v1.0/reports/";
	aq.auth(handle).progress(R.id.progress).ajax(url, JSONArray.class, this, "basicCb");
	
}

}}}

Use the BasicHandle for basic authentication. The default implementation does not handle authentication error (user changed password, etc...). 

Developer must check for authentication error (ex. code == 401) and create a new BasicHandle for subsequent requests.

==Extension==

Developers can extend the authentication framework for other web services by extending AccountHandle.

Documentation pending.

===Dismiss Dialogs===

Call AndroidQuery.dismiss() to dismiss any showing dialogs. 

{{{
aq.dismiss();
}}}